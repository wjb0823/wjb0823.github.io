<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">






















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">

<link rel="stylesheet" href="/css/main.css?v=7.1.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.2">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.2" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Explain性能分析1.Explain 概述使用 EXPLAIN 关键字可以模拟优化器来执行SQL查询语句，从而知道MySQL是如何处理我们的SQL语句的。分析出查询语句或是表结构的性能瓶颈。  MySQL查询过程    通过explain我们可以获得以下信息：  表的读取顺序 数据读取操作的操作类型 哪些索引可以被使用 哪些索引真正被使用 表的直接引用 每张表的有多少行被优化器查询了  Exp">
<meta name="keywords" content="MySQL">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL_索引优化">
<meta property="og:url" content="http://yoursite.com/2018/08/23/mysql/012.MySQL_索引优化/index.html">
<meta property="og:site_name" content="生活值得">
<meta property="og:description" content="Explain性能分析1.Explain 概述使用 EXPLAIN 关键字可以模拟优化器来执行SQL查询语句，从而知道MySQL是如何处理我们的SQL语句的。分析出查询语句或是表结构的性能瓶颈。  MySQL查询过程    通过explain我们可以获得以下信息：  表的读取顺序 数据读取操作的操作类型 哪些索引可以被使用 哪些索引真正被使用 表的直接引用 每张表的有多少行被优化器查询了  Exp">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/images/02_图片/005.jpg">
<meta property="og:image" content="g:/%E4%B8%AD%E5%8D%8E%E7%9F%B3%E6%9D%89/%E6%9E%B6%E6%9E%84%E8%AF%BE/%E4%BA%92%E8%81%94%E7%BD%91%E9%A6%96%E5%B8%AD%E6%9E%B6%E6%9E%84%E5%B8%88%E7%9B%B4%E9%80%9A%E8%BD%A6/002.%E4%BA%92%E8%81%94%E7%BD%91%20Java%20%E6%9E%B6%E6%9E%84%E5%B8%88%E8%AE%AD%E7%BB%83%E8%90%A5%E3%80%90%E5%AF%B9%E6%A0%87%E5%A4%A7%E5%8E%82%20P7%E3%80%91/003%E9%98%B6%E6%AE%B5%E4%B8%89%EF%BC%9A%E5%BC%80%E6%BA%90%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90/02_MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/172~185%E8%B5%84%E6%96%99/MySQL%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98_%E6%9C%80%E7%BB%88%E8%AE%B2%E4%B9%89/02_%E5%9B%BE%E7%89%87/71.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/72.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/73.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/74.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/73.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/75.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/76.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/77.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/78.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/79.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/80.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/81.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/82.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/83.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片7/84.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/85.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/86.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/87.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/88.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/89.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/90.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/91.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/92.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/93.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/94.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/95.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/012.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/96.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/97.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/96.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/006.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/007.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/015.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/008.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/009.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/010.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/011.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/013.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/014.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/015.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/015.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/016.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/017.jpg">
<meta property="og:image" content="http://yoursite.com/images/02_图片/018.jpg">
<meta property="og:updated_time" content="2018-08-23T14:15:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MySQL_索引优化">
<meta name="twitter:description" content="Explain性能分析1.Explain 概述使用 EXPLAIN 关键字可以模拟优化器来执行SQL查询语句，从而知道MySQL是如何处理我们的SQL语句的。分析出查询语句或是表结构的性能瓶颈。  MySQL查询过程    通过explain我们可以获得以下信息：  表的读取顺序 数据读取操作的操作类型 哪些索引可以被使用 哪些索引真正被使用 表的直接引用 每张表的有多少行被优化器查询了  Exp">
<meta name="twitter:image" content="http://yoursite.com/images/02_图片/005.jpg">





  
  
  <link rel="canonical" href="http://yoursite.com/2018/08/23/mysql/012.MySQL_索引优化/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>MySQL_索引优化 | 生活值得</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">生活值得</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-首页">

    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-分类">

    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-归档">

    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/23/mysql/012.MySQL_索引优化/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="最光阴">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="生活值得">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">MySQL_索引优化

              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-08-23 22:15:27" itemprop="dateCreated datePublished" datetime="2018-08-23T22:15:27+08:00">2018-08-23</time>
            </span>
          

          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="Explain性能分析"><a href="#Explain性能分析" class="headerlink" title="Explain性能分析"></a>Explain性能分析</h3><h4 id="1-Explain-概述"><a href="#1-Explain-概述" class="headerlink" title="1.Explain 概述"></a>1.Explain 概述</h4><p>使用 <code>EXPLAIN</code> 关键字可以模拟优化器来执行SQL查询语句，从而知道MySQL是如何处理我们的SQL语句的。分析出查询语句或是表结构的性能瓶颈。</p>
<ul>
<li><strong>MySQL查询过程</strong></li>
</ul>
<p><img src="/images/02_图片/005.jpg" style="width:630px; height:370px"> </p>
<p>通过explain我们可以获得以下信息：</p>
<ul>
<li>表的读取顺序</li>
<li>数据读取操作的操作类型</li>
<li>哪些索引可以被使用</li>
<li>哪些索引真正被使用</li>
<li>表的直接引用</li>
<li>每张表的有多少行被优化器查询了</li>
</ul>
<p>Explain使用方式: <strong>explain+sql语句</strong>, 通过执行explain可以获得sql语句执行的相关信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> L1;</span><br></pre></td></tr></table></figure>
<p><img src="G:/%E4%B8%AD%E5%8D%8E%E7%9F%B3%E6%9D%89/%E6%9E%B6%E6%9E%84%E8%AF%BE/%E4%BA%92%E8%81%94%E7%BD%91%E9%A6%96%E5%B8%AD%E6%9E%B6%E6%9E%84%E5%B8%88%E7%9B%B4%E9%80%9A%E8%BD%A6/002.%E4%BA%92%E8%81%94%E7%BD%91%20Java%20%E6%9E%B6%E6%9E%84%E5%B8%88%E8%AE%AD%E7%BB%83%E8%90%A5%E3%80%90%E5%AF%B9%E6%A0%87%E5%A4%A7%E5%8E%82%20P7%E3%80%91/003%E9%98%B6%E6%AE%B5%E4%B8%89%EF%BC%9A%E5%BC%80%E6%BA%90%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90/02_MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/172~185%E8%B5%84%E6%96%99/MySQL%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98_%E6%9C%80%E7%BB%88%E8%AE%B2%E4%B9%89/02_%E5%9B%BE%E7%89%87/71.jpg" style="width:830px; height:70px">  </p>
<h4 id="2-Explain-详解"><a href="#2-Explain-详解" class="headerlink" title="2.Explain 详解"></a>2.Explain 详解</h4><p><strong>1) 数据准备</strong>  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建数据库</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> test_explain <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> <span class="string">'utf8'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> L1(<span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,title <span class="built_in">VARCHAR</span>(<span class="number">100</span>) );</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> L2(<span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,title <span class="built_in">VARCHAR</span>(<span class="number">100</span>) );</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> L3(<span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,title <span class="built_in">VARCHAR</span>(<span class="number">100</span>) );</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> L4(<span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,title <span class="built_in">VARCHAR</span>(<span class="number">100</span>) );</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 每张表插入3条数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> L1(title) <span class="keyword">VALUES</span>(<span class="string">'ruyuan001'</span>),(<span class="string">'ruyuan002'</span>),(<span class="string">'ruyuan003'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> L2(title) <span class="keyword">VALUES</span>(<span class="string">'ruyuan004'</span>),(<span class="string">'ruyuan005'</span>),(<span class="string">'ruyuan006'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> L3(title) <span class="keyword">VALUES</span>(<span class="string">'ruyuan007'</span>),(<span class="string">'ruyuan008'</span>),(<span class="string">'ruyuan009'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> L4(title) <span class="keyword">VALUES</span>(<span class="string">'ruyuan010'</span>),(<span class="string">'ruyuan011'</span>),(<span class="string">'ruyuan012'</span>);</span><br></pre></td></tr></table></figure>
<p><strong>2) ID字段说明</strong></p>
<p><strong>select查询的序列号，包含一组数字，表示查询中执行select子句或操作表的顺序</strong></p>
<ul>
<li><p>id相同，执行顺序由上至下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span>  L1,L2,L3 <span class="keyword">WHERE</span> L1.id=L2.id <span class="keyword">AND</span> L2.id = L3.id;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/72.jpg" style="width:830px; height:70px"> </p>
</li>
</ul>
<ul>
<li><p>id不同，如果是子查询，id的序号会递增，<strong>id值越大优先级越高，越先被执行</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L2 <span class="keyword">WHERE</span> <span class="keyword">id</span> = (</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="keyword">id</span> <span class="keyword">FROM</span> L1 <span class="keyword">WHERE</span> <span class="keyword">id</span> = (<span class="keyword">SELECT</span> L3.id <span class="keyword">FROM</span> L3 <span class="keyword">WHERE</span> L3.title = <span class="string">'ruyuan007'</span>));</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/73.jpg" style="width:830px; height:70px"> </p>
</li>
</ul>
<p><strong>3) select_type和table字段说明</strong> </p>
<p><strong>表示查询类型，主要用于区别普通查询，联合查询，子查询等的复杂查询</strong></p>
<ul>
<li><p><code>simple</code> :  简单的select查询，查询中不包含子查询或者UNION</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L1 <span class="keyword">where</span> <span class="keyword">id</span> = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/74.jpg" style="width:830px; height:70px"> </p>
</li>
</ul>
<ul>
<li><p><code>primary</code> :  查询中若包含任何复杂的子部分，最外层查询被标记</p>
</li>
<li><p><code>subquery</code> : 在select或where列表中包含了子查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L2 <span class="keyword">WHERE</span> <span class="keyword">id</span> = (</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="keyword">id</span> <span class="keyword">FROM</span> L1 <span class="keyword">WHERE</span> <span class="keyword">id</span> = (<span class="keyword">SELECT</span> L3.id <span class="keyword">FROM</span> L3 <span class="keyword">WHERE</span> L3.title = <span class="string">'ruyuan08'</span>));</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/73.jpg" style="width:830px; height:70px"></p>
</li>
</ul>
<ul>
<li><p><code>union</code> :  union连接的两个select查询，第一个查询是dervied派生表，除了第一个表外，第二个以后的表select_type都是union</p>
</li>
<li><p><code>derived</code> : 在from列表中包含的子查询被标记为derived（派生表），MySQL会递归执行这些子查询，把结果放到临时表中</p>
</li>
<li><p><code>union result</code> : UNION 的结果 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">select</span> * <span class="keyword">from</span> L3 <span class="keyword">union</span> <span class="keyword">select</span> * <span class="keyword">from</span> L4)a;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/75.jpg" style="width:830px; height:80px"> </p>
</li>
</ul>
<p><strong>4) type字段说明</strong></p>
<p>type字段在 MySQL 官网文档描述如下：</p>
<blockquote>
<p>The join type. For descriptions of the different types.</p>
</blockquote>
<p><strong>type字段显示的是连接类型 ( join type表示的是用什么样的方式来获取数据)，它描述了找到所需数据所使用的扫描方式, 是较为重要的一个指标。</strong> </p>
<p>下面给出各种连接类型,按照从最佳类型到最坏类型进行排序:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 完整的连接类型比较多</span></span><br><span class="line">system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALL</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 简化之后,我们可以只关注一下几种</span></span><br><span class="line">system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; ALL</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>一般来说,需要保证查询至少达到 range级别,最好能到ref,否则就要就行SQL的优化调整</strong>   </p>
</blockquote>
<p>下面介绍type字段不同值表示的含义: </p>
<ul>
<li><p><strong>system: </strong>  表中就仅有一行数据的时候. 这是const连接类型的一个特例,很少出现。</p>
</li>
<li><p><strong>const: </strong> const表示命中主键索引(primary key) 或者唯一索引(unique),表示通过索引一次就找到数据记录.</p>
<p>因为只匹配一条记录,所以被连接的部分是一个常量. (如果将主键放在 where条件中, MySQL就能将该查询转换为一个常量) 这种类型非常快.</p>
<p>例如以下查询:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> L1 <span class="keyword">where</span> <span class="keyword">id</span> = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 为L1表的title字段添加唯一索引</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> L1 <span class="keyword">add</span> <span class="keyword">unique</span>(title);</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> L1 <span class="keyword">where</span> title = <span class="string">'ruyuan001'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/76.jpg" style="width:830px; height:80px"> </p>
</li>
</ul>
<ul>
<li><p><strong>eq_ref</strong> : 对于前一个表中的每个一行，后表只有一行被扫描。除了system和const类型之外，这是最好的连接类型。只有当联接使用索引的部分都是主键或惟一非空索引时，才会出现这种类型。</p>
<p>例如以下查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> L1.id,L1.title <span class="keyword">FROM</span> L1 <span class="keyword">left</span> <span class="keyword">join</span> L2 <span class="keyword">on</span> L1.id = L2.id;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/77.jpg" style="width:830px; height:80px"> </p>
</li>
</ul>
<ul>
<li><p><strong>ref </strong>: 非唯一性索引扫描(使用了普通索引), 对于前表的每一行(row)，后表可能有多于一行的数据被扫描,它返回所有匹配某个单独值的行.</p>
<p>例如以下查询:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 为L1表的title字段添加普通索引</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> L1 <span class="keyword">add</span> <span class="keyword">index</span> idx_title (title) ;</span><br><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L1 <span class="keyword">inner</span> <span class="keyword">join</span> L2 <span class="keyword">on</span> L1.title = L2.title;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/78.jpg" style="width:830px; height:80px"> </p>
</li>
</ul>
<ul>
<li><p><strong>range </strong>:  索引上的范围查询,检索给定范围的行,between，in函数，&gt; 都是典型的范围(range)查询, 例如以下查询: </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L1 <span class="keyword">WHERE</span> L1.id <span class="keyword">between</span> <span class="number">1</span> <span class="keyword">and</span>  <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/79.jpg" style="width:830px; height:80px"> </p>
<blockquote>
<p>注: 当in函数中的数据很大时,可能会导致效率下降,最终不走索引</p>
</blockquote>
</li>
</ul>
<ul>
<li><p><strong>index </strong>:   出现index 是 SQL 使用了索引, 但是没有通过索引进行过滤,需要扫描索引上的全部数据 ( <code>查找所有索引树,比ALL快一些,因为索引文件要比数据文件小</code> ), 一般是使用了索引进行排序分组.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L2 <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">id</span>  <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">id</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 该count查询需要通过扫描索引上的全部数据来计数</span></span><br><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> <span class="keyword">count</span>(*) <span class="keyword">FROM</span> L2;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/80.jpg" style="width:830px; height:80px"> </p>
</li>
</ul>
<ul>
<li><p><strong>ALL</strong> : 没有使用到任何索引, 连接查询时对于前表的每一行，后表都要被全表扫描。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L3 <span class="keyword">inner</span> <span class="keyword">join</span> L4 <span class="keyword">on</span> L3.title = L4.title ;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/81.jpg" style="width:830px; height:80px"> </p>
</li>
</ul>
<ul>
<li><p>总结各类type类型的特点:</p>
<p>| <strong>type类型</strong> | <strong>解释</strong>                                                     |<br>| —————— | —————————————————————————————— |<br>| <strong>system</strong>   | <strong>不进行磁盘IO,查询系统表,仅仅返回一条数据</strong>                 |<br>| <strong>const</strong>    | <strong>查找主键索引,最多返回1条或0条数据. 属于精确查找</strong>          |<br>| <strong>eq_ref</strong>   | <strong>查找唯一性索引,返回数据最多一条, 属于精确查找</strong>            |<br>| <strong>ref</strong>      | <strong>查找非唯一性索引,返回匹配某一条件的多条数据,属于精确查找,数据返回可能是多条.</strong> |<br>| <strong>range</strong>    | <strong>查找某个索引的部分索引,只检索给定范围的行,属于范围查找. 比如: &gt; 、 &lt; 、in 、between</strong> |<br>| <strong>index</strong>    | <strong>查找所有索引树,比ALL快一些,因为索引文件要比数据文件小.</strong>   |<br>| <strong>ALL</strong>      | <strong>不使用任何索引,直接进行全表扫描</strong>                          |</p>
</li>
</ul>
<p><strong>5) possible_keys 与 key说明</strong> </p>
<ul>
<li><p>possible_keys </p>
<p><strong>显示可能应用到这张表上的索引</strong>, 一个或者多个. 查询涉及到的字段上若存在索引, 则该索引将被列出, 但不一定被查询实际使用.</p>
</li>
<li><p>key</p>
<p><strong>实际使用的索引</strong>，若为null，则没有使用到索引。（两种可能，1.没建立索引, 2.建立索引，但索引失效）。查询中若使用了覆盖索引，则该索引仅出现在key列表中。</p>
</li>
</ul>
<ol>
<li>理论上没有使用索引,但实际上使用了</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> L3.id <span class="keyword">FROM</span> L3;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/82.jpg" style="width:830px; height:80px"> </p>
<ol>
<li>理论和实际上都没有使用索引</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L3 <span class="keyword">WHERE</span> title = <span class="string">'ruyuan007'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/83.jpg" style="width:830px; height:80px"> </p>
<ol>
<li>理论和实际上都使用了索引</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L2 <span class="keyword">WHERE</span> title = <span class="string">'ruyuan004'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片7/84.jpg" style="width:830px; height:80px"> </p>
<p><strong>6) key_len字段说明</strong>  </p>
<p>表示索引中使用的字节数, 可以通过该列计算查询中使用索引的长度. </p>
<p>key_len 字段能够帮你检查是否充分利用了索引   <strong>ken_len 越长, 说明索引使用的越充分</strong> </p>
<ul>
<li><p>创建表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> L5(</span><br><span class="line">	a <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>, </span><br><span class="line">	b <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>, </span><br><span class="line">	c <span class="built_in">INT</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>, </span><br><span class="line">    d <span class="built_in">CHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用explain 进行测试</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L5 <span class="keyword">WHERE</span> a &gt; <span class="number">1</span> <span class="keyword">AND</span> b = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p><strong>观察key_len的值, 索引中只包含了1列 是int类型 ,所以,key_len是4字节。</strong> </p>
<p><img src="/images/02_图片/85.jpg" style="width:830px; height:80px"> </p>
</li>
<li><p>为b字段添加索引,进行测试</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> L5 <span class="keyword">ADD</span> <span class="keyword">INDEX</span> idx_b(b);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 执行SQL,这次将b字段也作为条件</span></span><br><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L5 <span class="keyword">WHERE</span> a &gt; <span class="number">1</span> <span class="keyword">AND</span> b = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p><strong>两列都使用了索引,所以,这里ken_len是8。</strong> </p>
<p><img src="/images/02_图片/86.jpg" style="width:830px; height:80px"> </p>
</li>
<li><p>为c、d字段添加联合索引,然后进行测试</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> L5 <span class="keyword">ADD</span> <span class="keyword">INDEX</span> idx_c_b(c,d);</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> L5 <span class="keyword">where</span> c = <span class="number">1</span> <span class="keyword">and</span> d = <span class="string">''</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/87.jpg" style="width:830px; height:80px"> </p>
<p><strong>c字段是int类型 4个字节, d字段是 char(10)代表的是10个字符相当30个字节</strong> </p>
<blockquote>
<p>数据库的字符集是utf8 一个字符3个字节,d字段是 char(10)代表的是10个字符相当30个字节,多出的一个字节用来表示是联合索引</p>
</blockquote>
</li>
</ul>
<p>  下面这个例子中,虽然使用了联合索引,但是可以根据ken_len的长度推测出该联合索引只使用了一部分,没有充分利用索引,还有优化空间.</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> L5 <span class="keyword">where</span> c = <span class="number">1</span> ;</span><br></pre></td></tr></table></figure>
<p>  <img src="/images/02_图片/88.jpg" style="width:830px; height:80px"> </p>
<p><strong>7) ref 字段说明</strong>  </p>
<p>显示索引的哪一列被使用了，如果可能的话，是一个常数。哪些列或常量被用于查找索引列上的值</p>
<ul>
<li><strong>L1.id=’1’; 1是常量 , ref = const</strong></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L1 <span class="keyword">WHERE</span>  L1.id=<span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/89.jpg" style="width:830px; height:80px"> </p>
<p><strong>8) rows 字段说明</strong>  </p>
<p>表示MySQL根据表统计信息及索引选用情况,估算的找到所需的记录所需要读取的行数</p>
<ul>
<li>L3中的title没有添加索引, 所以L3中有3条记录,就需要读取3条记录进行查找.</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> L3,L4 <span class="keyword">WHERE</span> L3.id = L4.id <span class="keyword">AND</span> L3.title <span class="keyword">LIKE</span> <span class="string">'ruyuan007'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/90.jpg" style="width:830px; height:80px">  </p>
<blockquote>
<p>需要注意的是 rows只是一个估算值,并不准确 .所以rows行数过大的问题并不值得过多考虑，主要分析的还是索引是否使用正确了</p>
</blockquote>
<p><strong>9) filtered 字段说明</strong> </p>
<ul>
<li>它指返回结果的行占需要读到的行(rows列的值)的百分比</li>
</ul>
<p><strong>10) extra 字段说明 </strong></p>
<p>Extra 是 EXPLAIN 输出中另外一个很重要的列，该列显示MySQL在查询过程中的一些详细信息.</p>
<ul>
<li>准备数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">users</span> (</span><br><span class="line">	uid <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,</span><br><span class="line">	uname <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	age <span class="built_in">INT</span>(<span class="number">11</span>)</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> <span class="keyword">VALUES</span>(<span class="literal">NULL</span>, <span class="string">'lisa'</span>,<span class="number">10</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> <span class="keyword">VALUES</span>(<span class="literal">NULL</span>, <span class="string">'lisa'</span>,<span class="number">10</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> <span class="keyword">VALUES</span>(<span class="literal">NULL</span>, <span class="string">'rose'</span>,<span class="number">11</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> <span class="keyword">VALUES</span>(<span class="literal">NULL</span>, <span class="string">'jack'</span>, <span class="number">12</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> <span class="keyword">VALUES</span>(<span class="literal">NULL</span>, <span class="string">'sam'</span>, <span class="number">13</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>Using filesort</strong></p>
<p>执行结果Extra为<code>Using filesort</code>，这说明，得到所需结果集，需要对所有记录进行文件排序。这类SQL语句性能极差，需要进行优化。</p>
<p>典型的，在一个没有建立索引的列上进行了order by，就会触发filesort，常见的优化方案是，在order by的列上添加索引，避免每次查询都全量排序。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> age;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/91.jpg" style="width:830px; height:80px"> </p>
</li>
<li><p><strong>Using temporary</strong></p>
<p>表示MySQL需要使用临时表来存储结果集，常见于排序和分组查询  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*),uname <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> uname;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/92.jpg" style="width:830px; height:80px"> </p>
</li>
<li><p><strong>Using where</strong></p>
<p>意味着全表扫描或者在查找使用索引的情况下,但是还有查询条件不在索引字段当中.</p>
<p><strong>需要注意的是：</strong></p>
<ol>
<li>返回所有记录的SQL，不使用where条件过滤数据，大概率不符合预期，对于这类SQL往往需要进行优化；</li>
<li>使用了where条件的SQL，并不代表不需要优化，往往需要配合explain结果中的type（连接类型）来综合判断。例如本例查询的 age 未设置索引，所以返回的type为ALL，仍有优化空间，可以建立索引优化查询。</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> age=<span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/93.jpg" style="width:830px; height:80px"> </p>
</li>
<li><p><strong>Using index</strong></p>
<p>表示直接访问索引就能够获取到所需要的数据(覆盖索引) , 不需要通过索引回表.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 为uname创建索引</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">users</span> <span class="keyword">add</span> <span class="keyword">index</span> idx_uname(uname);</span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> uid,uname <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> uname=<span class="string">'lisa'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/94.jpg" style="width:830px; height:80px"> </p>
</li>
<li><p><strong>Using join buffer</strong></p>
<p>使用了连接缓存, 会显示join连接查询时,MySQL选择的查询算法  .</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> u1 <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> age = <span class="number">1</span>) u2 <span class="keyword">ON</span> u1.age = u2.age;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/95.jpg" style="width:830px; height:80px">  </p>
<p><code>Using join buffer (Block Nested Loop)</code> 说明，需要进行嵌套循环计算, 这里每个表都有五条记录，内外表查询的type都为ALL。</p>
<p>问题在于 两个关联表的关联使用了字段 age，并且age字段未建立索引，就会出现这种情况。</p>
</li>
<li><p><strong>Using index condition</strong></p>
<p>查找使用了索引 (但是只使用了一部分,一般是指联合索引)，但是需要回表查询数.     </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> L5 <span class="keyword">where</span> c &gt; <span class="number">10</span> <span class="keyword">and</span> d = <span class="string">''</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/012.jpg" style="width:830px; height:80px"> </p>
</li>
</ul>
<p><strong>Extra主要指标的含义(有时会同时出现)</strong></p>
<ul>
<li><code>using index</code> ：使用覆盖索引的时候就会出现</li>
<li><code>using where</code>：在查找使用索引的情况下，需要回表去查询所需的数据</li>
<li><code>using index condition</code>：查找使用了索引，但是需要回表查询数据</li>
<li><code>using index &amp; using where</code>：查找使用了索引，但是需要的数据都在索引列中能找到，所以不需要回表查询数据</li>
</ul>
<h3 id="索引优化原则"><a href="#索引优化原则" class="headerlink" title="索引优化原则"></a>索引优化原则</h3><h4 id="1-数据准备"><a href="#1-数据准备" class="headerlink" title="1.数据准备"></a>1.数据准备</h4><p>上面我们学习到了使用explain命令帮助我们分析索引的执行情况，接下来我们继续深入谈谈索引优化的一些原则和具体场景的优化方式。 </p>
<ul>
<li><p>创建数据库、表,插入数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> idx_optimize <span class="built_in">character</span> <span class="keyword">set</span> <span class="string">'utf8'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">users</span>(</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,</span><br><span class="line">  user_name <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'姓名'</span>,</span><br><span class="line">  user_age <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> <span class="keyword">COMMENT</span> <span class="string">'年龄'</span>,</span><br><span class="line">  user_level <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'用户等级'</span>,</span><br><span class="line">  reg_time <span class="built_in">TIMESTAMP</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">COMMENT</span> <span class="string">'注册时间'</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span>(user_name,user_age,user_level,reg_time)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">'tom'</span>,<span class="number">17</span>,<span class="string">'A'</span>,<span class="keyword">NOW</span>()),(<span class="string">'jack'</span>,<span class="number">18</span>,<span class="string">'B'</span>,<span class="keyword">NOW</span>()),(<span class="string">'lucy'</span>,<span class="number">18</span>,<span class="string">'C'</span>,<span class="keyword">NOW</span>());</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建联合索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="keyword">users</span> <span class="keyword">ADD</span> <span class="keyword">INDEX</span> idx_nal (user_name,user_age,user_level) <span class="keyword">USING</span> BTREE;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2-优化原则详解"><a href="#2-优化原则详解" class="headerlink" title="2.优化原则详解"></a>2.优化原则详解</h4><p><strong>1)最佳左前缀法则</strong>  </p>
<p>最佳左前缀法则:  如果创建的是联合索引,就要遵循该法则. 使用索引时，where后面的条件需要从索引的最左前列开始使用,并且不能跳过索引中的列使用。</p>
<ul>
<li><p>场景1:  按照索引字段顺序使用，三个字段都使用了索引,没有问题。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name = <span class="string">'tom'</span> </span><br><span class="line"><span class="keyword">AND</span> user_age = <span class="number">17</span> <span class="keyword">AND</span> user_level = <span class="string">'A'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/96.jpg" style="width:830px; height:80px"> </p>
</li>
</ul>
<ul>
<li><p>场景2: 直接跳过user_name使用索引字段，索引无效，未使用到索引。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_age = <span class="number">17</span> <span class="keyword">AND</span> user_level = <span class="string">'A'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/97.jpg" style="width:830px; height:70px">  </p>
</li>
</ul>
<ul>
<li><p>场景3:  不按照创建联合索引的顺序,使用索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> </span><br><span class="line">user_age = <span class="number">17</span> <span class="keyword">AND</span> user_name = <span class="string">'tom'</span> <span class="keyword">AND</span> user_level = <span class="string">'A'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/96.jpg" style="width:830px; height:80px"> </p>
</li>
</ul>
<p>  where后面查询条件顺序是 <code>user_age</code>、<code>user_level</code>、<code>user_name</code>与我们创建的索引顺序<code>user_name</code>、<code>user_age</code>、<code>user_level</code>不一致，为什么还是使用了索引，原因是因为MySql底层优化器对其进行了优化。</p>
<ul>
<li><p><strong>最佳左前缀底层原理</strong></p>
<p>MySQL创建联合索引的规则是: 首先会对联合索引<strong>最左边</strong>的字段进行<strong>排序</strong>  ( 例子中是 <code>user_name</code> ), <strong>在第一个字段的基础之上</strong> 再对第二个字段进行排序 ( 例子中是 <code>user_age</code> ) .</p>
<p>所以: 最佳左前缀原则其实是和B+树的结构有关系, 最左字段肯定是有序的, 第二个字段则是无序的(<strong>联合索引的排序方式是: 先按照第一个字段进行排序,如果第一个字段相等再根据第二个字段排序</strong>). 所以如果直接使用第二个字段 <code>user_age</code> 通常是使用不到索引的.</p>
<p><img src="/images/02_图片/006.jpg" style="width:630px; height:280px"> </p>
</li>
</ul>
<p><strong>2) 不要在索引列上做任何计算</strong> </p>
<p>不要在索引列上做任何操作，比如计算、使用函数、自动或手动进行类型转换,会导致索引失效，从而使查询转向全表扫描。</p>
<ul>
<li><p>插入数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span>(user_name,user_age,user_level,reg_time) <span class="keyword">VALUES</span>(<span class="string">'11223344'</span>,<span class="number">22</span>,<span class="string">'D'</span>,<span class="keyword">NOW</span>());</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>场景1:  使用系统函数 left()函数,对user_name进行操作</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> <span class="keyword">LEFT</span>(user_name, <span class="number">6</span>) = <span class="string">'112233'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/007.jpg" style="width:630px; height:80px"> </p>
</li>
</ul>
<ul>
<li><p>场景2:  字符串不加单引号 (隐式类型转换)</p>
<p>varchar类型的字段，在查询的时候不加单引号,就需要进行隐式转换, 导致索引失效，转向全表扫描。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name = <span class="number">11223344</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/015.jpg" style="width:830px; height:70px"> </p>
</li>
</ul>
<p><strong>3) 范围之后全失效</strong>  </p>
<p>在编写查询语句时, where条件中如果有范围条件, 并且范围条件之后还有其他过滤条件,   那么范围条件之后的列就都将会索引失效. </p>
<ul>
<li><p>场景1: 条件单独使用user_name时,  <code>type=ref</code>,   <code>key_len=62</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 条件只有一个 user_name</span></span><br><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name = <span class="string">'tom'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/008.jpg" style="width:630px; height:80px"> </p>
</li>
<li><p>场景2: 条件增加一个 user_age ( 使用常量等值) ,<code>type= ref</code>  ,  <code>key_len = 66</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name = <span class="string">'tom'</span> <span class="keyword">AND</span> user_age = <span class="number">17</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/009.jpg" style="width:630px; height:80px"> </p>
</li>
<li><p>场景3: 使用全值匹配, <code>type = ref</code>  , <code>key_len = 128</code>  , 索引都利用上了.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name = <span class="string">'tom'</span> </span><br><span class="line"><span class="keyword">AND</span> user_age = <span class="number">17</span> <span class="keyword">AND</span> user_level = <span class="string">'A'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/010.jpg" style="width:830px; height:80px"> </p>
</li>
<li><p>场景4: 使用范围条件时, avg &gt; 17 , <code>type = range</code>  ,  <code>key_len = 66</code>   , 与场景3 比较,可以发现 <code>user_level</code> 索引没有用上.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name = <span class="string">'tom'</span> </span><br><span class="line"><span class="keyword">AND</span> user_age &gt; <span class="number">17</span> <span class="keyword">AND</span> user_level = <span class="string">'A'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/011.jpg" style="width:830px; height:80px"> </p>
<p><img src="/images/02_图片/013.jpg" style="width:830px; height:90px">  </p>
</li>
</ul>
<p><strong>4) 避免使用 is null 、 is not null、!= 、or</strong></p>
<ul>
<li><p>使用 <code>is null</code> 会使索引失效</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/014.jpg" style="width:830px; height:80px"> </p>
<blockquote>
<p>Impossible Where:  表示where条件不成立, 不能返回任何行</p>
</blockquote>
</li>
<li><p>使用 <code>is not null</code> 会使索引失效</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/015.jpg" style="width:830px; height:70px"> </p>
</li>
<li><p>使用 <code>!=</code>  和 <code>or</code> 会使索引失效</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name != <span class="string">'tom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name = <span class="string">'tom'</span> <span class="keyword">or</span> user_name = <span class="string">'jack'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/015.jpg" style="width:830px; height:70px"> </p>
</li>
</ul>
<p><strong>5)  like以%开头会使索引失效</strong></p>
<p>like查询为范围查询，%出现在左边，则索引失效。%出现在右边索引未失效.</p>
<ul>
<li><p>场景1: 两边都有% 或者 字段右边有%,索引都会失效</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name <span class="keyword">LIKE</span> <span class="string">'%tom%'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name <span class="keyword">LIKE</span> <span class="string">'%tom'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/016.jpg" style="width:830px; height:70px"> </p>
</li>
</ul>
<ul>
<li><p>场景2: 字段左边有%,索引生效</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name <span class="keyword">LIKE</span> <span class="string">'tom%'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/017.jpg" style="width:830px; height:70px"></p>
</li>
</ul>
<p><strong>解决%出现在左边索引失效的方法</strong></p>
<ul>
<li><p>使用覆盖索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> user_name <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name <span class="keyword">LIKE</span> <span class="string">'%jack%'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> user_name,user_age,user_level <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> user_name <span class="keyword">LIKE</span> <span class="string">'%jack%'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/images/02_图片/018.jpg" style="width:830px; height:70px"></p>
<p>对比场景1可以知道, 通过使用覆盖索引 <code>type = index</code>,并且 <code>extra = Using index</code>,从全表扫描变成了全索引扫描.</p>
</li>
</ul>
<ul>
<li><p>like 失效的原理</p>
<ol>
<li><p><strong>%号在右:</strong> 由于B+树的索引顺序，是按照首字母的大小进行排序，%号在右的匹配又是匹配首字母。所以可以在B+树上进行有序的查找，查找首字母符合要求的数据。所以有些时候可以用到索引.</p>
</li>
<li><p><strong>%号在左:</strong>  是匹配字符串尾部的数据，我们上面说了排序规则，尾部的字母是没有顺序的，所以不能按照索引顺序查询，就用不到索引.</p>
</li>
<li><p><strong>两个%%号:</strong>  这个是查询任意位置的字母满足条件即可，只有首字母是进行索引排序的，其他位置的字母都是相对无序的，所以查找任意位置的字母是用不上索引的.</p>
</li>
</ol>
</li>
</ul>
<p><strong>索引优化原则总结</strong> </p>
<ul>
<li><strong>最左前缀法则要遵守</strong> </li>
<li><strong>索引列上不计算</strong></li>
<li><strong>范围之后全失效</strong></li>
<li><strong>覆盖索引记住用。</strong></li>
<li><strong>不等于、is null、is not null、or导致索引失效。</strong></li>
<li><strong>like百分号加右边，加左边导致索引失效，解决方法：使用覆盖索引。</strong></li>
</ul>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        
          
        
        <div class="post-tags">
          
            <a href="/tags/MySQL/" rel="tag"># MySQL</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/08/23/mysql/016.MySQL_索引优化实战/" rel="next" title="MySQL_索引优化实战">
                <i class="fa fa-chevron-left"></i> MySQL_索引优化实战
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/08/23/mysql/011.MySQL_索引原理/" rel="prev" title="MySQL_索引原理">
                MySQL_索引原理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">最光阴</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives">
                
                    <span class="site-state-item-count">83</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">标签</span>
                  
                </div>
              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Explain性能分析"><span class="nav-text">Explain性能分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-Explain-概述"><span class="nav-text">1.Explain 概述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Explain-详解"><span class="nav-text">2.Explain 详解</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#索引优化原则"><span class="nav-text">索引优化原则</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-数据准备"><span class="nav-text">1.数据准备</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-优化原则详解"><span class="nav-text">2.优化原则详解</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 – <span itemprop="copyrightYear">2023</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">最光阴</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.1.2</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.2"></script>

  <script src="/js/motion.js?v=7.1.2"></script>



  
  


  <script src="/js/affix.js?v=7.1.2"></script>

  <script src="/js/schemes/pisces.js?v=7.1.2"></script>




  
  <script src="/js/scrollspy.js?v=7.1.2"></script>
<script src="/js/post-details.js?v=7.1.2"></script>



  


  <script src="/js/next-boot.js?v=7.1.2"></script>


  

  

  

  


  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
